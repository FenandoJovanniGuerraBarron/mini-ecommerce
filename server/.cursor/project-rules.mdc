---
description: 
globs: *.js
alwaysApply: false
---
# ğŸ“‹ PROJECT RULES - Mini E-commerce API

## ğŸ—ï¸ **Arquitectura del Proyecto**

### **Stack TecnolÃ³gico**
- **Backend**: Node.js + Express.js
- **Base de Datos**: MySQL con Sequelize ORM
- **AutenticaciÃ³n**: JWT (jsonwebtoken)
- **EncriptaciÃ³n**: bcrypt para contraseÃ±as
- **GestiÃ³n de Dependencias**: npm/pnpm

### **Estructura de Directorios**
```
server/
â”œâ”€â”€ database/
â”‚   â”œâ”€â”€ config/          # ConfiguraciÃ³n de Sequelize
â”‚   â”œâ”€â”€ migrations/      # Migraciones de base de datos
â”‚   â”œâ”€â”€ models/          # Modelos de Sequelize
â”‚   â””â”€â”€ seeders/         # Datos de prueba
â”œâ”€â”€ controllers/         # Controladores de la API
â”œâ”€â”€ services/           # LÃ³gica de negocio
â”œâ”€â”€ routes/             # DefiniciÃ³n de rutas
â”œâ”€â”€ middleware/         # Middlewares personalizados
â”œâ”€â”€ utils/              # Utilidades y helpers
â”œâ”€â”€ scripts/            # Scripts personalizados
â”œâ”€â”€ app.js              # Punto de entrada de la aplicaciÃ³n
â”œâ”€â”€ config.js           # ConfiguraciÃ³n general
â””â”€â”€ .sequelizerc        # ConfiguraciÃ³n de Sequelize CLI
```

## ğŸ“ **Convenciones de CÃ³digo**

### **Nomenclatura**
- **Archivos**: kebab-case (ej: `product-routes.js`)
- **Directorios**: kebab-case (ej: `database/models`)
- **Clases**: PascalCase (ej: `User`, `Product`)
- **Variables/Funciones**: camelCase (ej: `getAllProducts`, `userId`)
- **Constantes**: UPPERCASE (ej: `JWT_SECRET`)
- **Variables booleanas**: verbos (ej: `isAuthenticated`, `hasError`)

### **Patrones de DiseÃ±o**
- **SeparaciÃ³n de Responsabilidades**: Controllers â†’ Services â†’ Models
- **Un export por archivo**
- **Sin lÃ­neas en blanco dentro de funciones**
- **Cada funciÃ³n comienza con un verbo**

## ğŸ” **AutenticaciÃ³n y Seguridad**

### **JWT Implementation**
- **Secret**: Configurado en variables de entorno (`JWT_SECRET`)
- **Middleware**: `auth.middleware.js` para proteger rutas
- **Servicio**: `auth.service.js` para lÃ³gica de autenticaciÃ³n

### **EncriptaciÃ³n**
- **ContraseÃ±as**: bcrypt con salt rounds
- **Variables sensibles**: En archivo `.env`

## ğŸ—„ï¸ **Base de Datos**

### **Modelos Implementados**
- **User**: Usuarios del sistema
- **Product**: Productos del catÃ¡logo
- **Order**: Ã“rdenes de compra
- **OrderItem**: Items de cada orden

### **Relaciones**
- User â†” Order (1:N)
- Order â†” OrderItem (1:N)
- Product â†” OrderItem (1:N)

### **Migraciones**
- CreaciÃ³n de tablas con timestamps
- Claves forÃ¡neas definidas en migraciÃ³n separada
- Ãndices para optimizaciÃ³n

## ğŸ›£ï¸ **API Endpoints**

### **Estructura de Respuesta**
```javascript
{
  success: boolean,
  data?: any,
  message: string,
  error?: string
}
```

### **Rutas Implementadas**
- **Productos**: `GET /api/products`, `GET /api/products/:id`
- **Usuarios**: `POST /api/users` (registro)
- **AutenticaciÃ³n**: `POST /api/auth/login`
- **Carrito**: `POST /api/cart/add`, `GET /api/cart` (pendiente)

### **CÃ³digos de Estado HTTP**
- `200`: Ã‰xito
- `201`: Creado
- `400`: Error de validaciÃ³n
- `401`: No autorizado
- `404`: No encontrado
- `500`: Error interno del servidor

## ğŸ”§ **ConfiguraciÃ³n y Scripts**

### **Scripts NPM**
- `npm run dev`: Desarrollo con nodemon
- `npm start`: ProducciÃ³n
- `npm run migration:run`: Ejecutar migraciones
- `npm run seed:run`: Ejecutar seeders

### **Variables de Entorno Requeridas**
```env
DB_USER=usuario
DB_PASS=contraseÃ±a
DB_NAME=nombre_db
DB_HOST=localhost
JWT_SECRET=secret_jwt
```

## ğŸš¨ **Reglas Importantes**

### **Desarrollo**
1. **NO modificar archivos sin consultar al usuario**
2. **Seguir las convenciones establecidas**
3. **Implementar manejo de errores en todos los endpoints**
4. **Validar datos de entrada**
5. **Usar async/await para operaciones asÃ­ncronas**

### **ComunicaciÃ³n**
- **Respuestas en espaÃ±ol** para el usuario
- **CÃ³digo y documentaciÃ³n en inglÃ©s**
- **Mensajes de commit en inglÃ©s** y descriptivos

### **Prueba TÃ©cnica - Requisitos Pendientes**
- âœ… Productos (GET)
- âœ… Usuarios (POST /register)
- âœ… AutenticaciÃ³n (POST /login)
- âŒ Carrito (POST /cart/add, GET /cart)
- âŒ Checkout (POST /checkout)

## ğŸ“Š **Estado Actual del Proyecto**
- **Base de datos**: Configurada y migrada
- **Modelos**: Implementados con relaciones
- **AutenticaciÃ³n**: JWT implementado
- **Productos**: Endpoints bÃ¡sicos funcionando
- **Usuarios**: Registro implementado
- **Carrito**: Servicio creado, pendiente controlador y rutas
- **Checkout**: Pendiente implementaciÃ³n

## ğŸ”„ **Flujo de Trabajo**
1. **AnÃ¡lisis**: Revisar requisitos y estado actual
2. **PlanificaciÃ³n**: Definir pasos a seguir
3. **ImplementaciÃ³n**: Crear archivos paso a paso
4. **ValidaciÃ³n**: Verificar que todo funcione correctamente
5. **DocumentaciÃ³n**: Actualizar estado del proyecto 